# Learnings

Distilled patterns and gotchas for future agents working on anki-renderer.

## Project Structure

- **Type**: Rust → WASM library with npm package
- **Main crate**: `anki-renderer` in root
- **WASM output**: `pkg/` directory (generated by wasm-pack, gitignored)
- **Entry point**: `src/lib.rs`

## Commands

```bash
# Local development
cargo build              # Build Rust
cargo test               # Run tests
cargo clippy -- -D warnings  # Lint

# WASM build
wasm-pack build --target web --out-dir pkg

# Package verification
cd pkg && npm pack
```

## CI

- GitHub Actions at `.github/workflows/ci.yml`
- Runs: lint → test → wasm-pack build → verify .wasm exists
- Uses `dtolnay/rust-toolchain@stable` (NOT rust-action)

## Patterns

- All exported functions need `#[wasm_bindgen]` attribute
- Prefix unused parameters with `_` to avoid lint warnings
- `JsError` is the WASM-compatible error type

## Gotchas

- The action is `dtolnay/rust-toolchain` not `rust-action`
- wasm-pack installer script requires rustup to be visible in PATH
